---
name: react-composition
description:
  React composition patterns that scale. Use when refactoring components with
  boolean prop proliferation, building flexible component libraries, or
  designing reusable APIs. Triggers on tasks involving compound components,
  render props, context providers, or component architecture. Includes React 19
  API changes.
---

# React Composition Patterns

Composition patterns for building flexible, maintainable React components. Avoid
boolean prop proliferation by using compound components, lifting state, and
composing internals. These patterns make codebases easier for both humans and AI
agents to work with as they scale.

## When to Apply

Reference these guidelines when:

- Refactoring components with many boolean props
- Building reusable component libraries
- Designing flexible component APIs
- Reviewing component architecture
- Working with compound components or context providers

## Rule Categories by Priority

| Priority | Category                | Impact | Prefix          |
| -------- | ----------------------- | ------ | --------------- |
| 1        | Component Architecture  | HIGH   | `architecture-` |
| 2        | State Management        | MEDIUM | `state-`        |
| 3        | Implementation Patterns | MEDIUM | `patterns-`     |
| 4        | React 19 APIs           | MEDIUM | `react19-`      |

## Quick Reference

### 1. Component Architecture (HIGH)

- `architecture-avoid-boolean-props` - Don't add boolean props to customize
  behavior; use composition
- `architecture-compound-components` - Structure complex components with shared
  context

### 2. State Management (MEDIUM)

- `state-decouple-implementation` - Provider is the only place that knows how
  state is managed
- `state-context-interface` - Define generic interface with state, actions, meta
  for dependency injection
- `state-lift-state` - Move state into provider components for sibling access

### 3. Implementation Patterns (MEDIUM)

- `patterns-explicit-variants` - Create explicit variant components instead of
  boolean modes
- `patterns-children-over-render-props` - Use children for composition instead
  of renderX props
- `patterns-polymorphic-as-prop` - Render as different elements via `as` prop
  for polymorphic components
- `patterns-slot-pattern` - Merge props onto child element via Slot/asChild
  for zero-wrapper composition
- `patterns-controlled-uncontrolled` - Support both controlled and uncontrolled
  modes for maximum reusability

### 4. React 19 APIs (MEDIUM)

> **⚠️ React 19+ only.** Skip this section if using React 18 or earlier.

- `react19-api-changes` - Don't use `forwardRef`; use `use()` instead of `useContext()`

## How to Use

Read individual reference files for detailed explanations and code examples:

```
references/architecture-avoid-boolean-props.md
references/state-context-interface.md
```

Each reference file contains:

- Brief explanation of why it matters
- Incorrect code example with explanation
- Correct code example with explanation
- Additional context and references

## Detailed References

- **Component Architecture**: `references/architecture-avoid-boolean-props.md`, `references/architecture-compound-components.md`
- **State Management**: `references/state-decouple-implementation.md`, `references/state-context-interface.md`, `references/state-lift-state.md`
- **Implementation Patterns**: `references/patterns-explicit-variants.md`, `references/patterns-children-over-render-props.md`, `references/patterns-polymorphic-as-prop.md`, `references/patterns-slot-pattern.md`, `references/patterns-controlled-uncontrolled.md`
- **React 19**: `references/react19-api-changes.md`
- **Anti-patterns**: `references/anti-patterns.md`

## Examples

- **Before/After comparisons**: `examples/before-after-examples.md`
  - Monolithic component to compound components
  - Boolean props to explicit variants
  - Prop drilling to provider-based state
  - Render props to children composition
- **Design system patterns**: `examples/design-system-patterns.md`
  - Polymorphic Text component
  - Dialog with Slot trigger
  - Controlled/Uncontrolled Tabs
  - Combining Compound + Slot + Controlled patterns
